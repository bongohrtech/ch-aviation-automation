{
    "commands": [
        {
            "0": {
                "name": "Delete Working_Hours_PurelyHR",
                "sql": "DELETE *FROM Working_Hours_PurelyHR;"
            }
        },
        {
            "1": {
                "name": "Update Holidays in Working_Hours",
                "sql": "UPDATE Working_Hours_PurelyHR AS WHP LEFT JOIN Holidays AS H ON WHP.Category = H.Name SET WHP.TimeIn = H.Date, WHP.TimeOut = H.DateWHERE WHP.TimeIn IS NULL;"
            }
        },
        {
            "10": {
                "name": "Report for Month 1 - Airlines",
                "sql": "SELECT DISTINCT MR.Lastname, MR.Firstname, MR.EmployeeID, MR.Day, MIN(MR.Time_In) AS TimeIn, W.Hours AS Worked, B.Hours AS Breaks, H.Hours AS Holiday, SL.Hours AS Sick_Leave, V.Hours AS Vacation, CL.Hours AS Compassionate_Leave, BT.Hours AS Business_Travel, ML.Hours AS Maternity_Leave, GL.Hours AS Gardening_Leave, EH.Hours AS Extra_Hours INTO Report_Month1_AirlinesFROM ((((((((((Monthly_Reporting_Data AS MR LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('Shift') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS W ON (W.Day = MR.Day) AND (W.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('Break','Lunch') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS B ON (B.Day = MR.Day) AND (B.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('Holiday') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS H ON (H.Day = MR.Day) AND (H.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Sick Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS SL ON (SL.Day = MR.Day) AND (SL.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Vacation') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS V ON (V.Day = MR.Day) AND (V.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Compassionate Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS CL ON (CL.Day = MR.Day) AND (CL.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Business travel') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS BT ON (BT.Day = MR.Day) AND (BT.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Maternity Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS ML ON (ML.Day = MR.Day) AND (ML.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Gardening Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS GL ON (GL.Day = MR.Day) AND (GL.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Extra Hours') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS EH ON (EH.Day = MR.Day) AND (EH.EmployeeID = MR.EmployeeID)) LEFT JOIN Month1 AS M1 ON (YEAR(MR.Day) = M1.current_year) AND (MONTH(MR.Day) = M1.current_month)WHERE Office In ('Zagreb Office','Zagreb Students') And Department In ('Airlines') And M1.current_month Is Not NullGROUP BY MR.Lastname, MR.Firstname, MR.EmployeeID, MR.Day, W.Hours, B.Hours, H.Hours, SL.Hours, V.Hours, CL.Hours, BT.Hours, ML.Hours, GL.Hours, EH.HoursORDER BY MR.EmployeeID, MR.Day;"
            }
        },
        {
            "10a": {
                "name": "Report for Month 1 - Fleets",
                "sql": "SELECT DISTINCT MR.Lastname, MR.Firstname, MR.EmployeeID, MR.Day, MIN(MR.Time_In) AS TimeIn, W.Hours AS Worked, B.Hours AS Breaks, H.Hours AS Holiday, SL.Hours AS Sick_Leave, V.Hours AS Vacation, CL.Hours AS Compassionate_Leave, BT.Hours AS Business_Travel, ML.Hours AS Maternity_Leave, GL.Hours AS Gardening_Leave, EH.Hours AS Extra_Hours INTO Report_Month1_FleetsFROM ((((((((((Monthly_Reporting_Data AS MR LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('Shift') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS W ON (W.Day = MR.Day) AND (W.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('Break','Lunch') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS B ON (B.Day = MR.Day) AND (B.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('Holiday') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS H ON (H.Day = MR.Day) AND (H.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Sick Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS SL ON (SL.Day = MR.Day) AND (SL.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Vacation') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS V ON (V.Day = MR.Day) AND (V.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Compassionate Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS CL ON (CL.Day = MR.Day) AND (CL.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Business travel') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS BT ON (BT.Day = MR.Day) AND (BT.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Maternity Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS ML ON (ML.Day = MR.Day) AND (ML.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Gardening Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS GL ON (GL.Day = MR.Day) AND (GL.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Extra Hours') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS EH ON (EH.Day = MR.Day) AND (EH.EmployeeID = MR.EmployeeID)) LEFT JOIN Month1 AS M1 ON (YEAR(MR.Day) = M1.current_year) AND (MONTH(MR.Day) = M1.current_month)WHERE Office In ('Zagreb Office','Zagreb Students') And Department In ('Fleets') And M1.current_month Is Not NullGROUP BY MR.Lastname, MR.Firstname, MR.EmployeeID, MR.Day, W.Hours, B.Hours, H.Hours, SL.Hours, V.Hours, CL.Hours, BT.Hours, ML.Hours, GL.Hours, EH.HoursORDER BY MR.EmployeeID, MR.Day;"
            }
        },
        {
            "10b": {
                "name": "Report for Month 1 - Admin and Management",
                "sql": "SELECT DISTINCT MR.Lastname, MR.Firstname, MR.EmployeeID, MR.Day, MIN(MR.Time_In) AS TimeIn, W.Hours AS Worked, B.Hours AS Breaks, H.Hours AS Holiday, SL.Hours AS Sick_Leave, V.Hours AS Vacation, CL.Hours AS Compassionate_Leave, BT.Hours AS Business_Travel, ML.Hours AS Maternity_Leave, GL.Hours AS Gardening_Leave, EH.Hours AS Extra_Hours INTO Report_Month1_Admin_MgmtFROM ((((((((((Monthly_Reporting_Data AS MR LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('Shift') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS W ON (W.Day = MR.Day) AND (W.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('Break','Lunch') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS B ON (B.Day = MR.Day) AND (B.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('Holiday') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS H ON (H.Day = MR.Day) AND (H.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Sick Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS SL ON (SL.Day = MR.Day) AND (SL.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Vacation') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS V ON (V.Day = MR.Day) AND (V.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Compassionate Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS CL ON (CL.Day = MR.Day) AND (CL.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Business travel') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS BT ON (BT.Day = MR.Day) AND (BT.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Maternity Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS ML ON (ML.Day = MR.Day) AND (ML.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Gardening Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS GL ON (GL.Day = MR.Day) AND (GL.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Extra Hours') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS EH ON (EH.Day = MR.Day) AND (EH.EmployeeID = MR.EmployeeID)) LEFT JOIN Month1 AS M1 ON (YEAR(MR.Day) = M1.current_year) AND (MONTH(MR.Day) = M1.current_month)WHERE Office In ('Zagreb Office','Zagreb Students') And Department In ('Administration','Management') And M1.current_month Is Not NullGROUP BY MR.Lastname, MR.Firstname, MR.EmployeeID, MR.Day, W.Hours, B.Hours, H.Hours, SL.Hours, V.Hours, CL.Hours, BT.Hours, ML.Hours, GL.Hours, EH.HoursORDER BY MR.EmployeeID, MR.Day;"
            }
        },
        {
            "10c": {
                "name": "Report for Month 1 - Sales",
                "sql": "SELECT DISTINCT MR.Lastname, MR.Firstname, MR.EmployeeID, MR.Day, MIN(MR.Time_In) AS TimeIn, W.Hours AS Worked, B.Hours AS Breaks, H.Hours AS Holiday, SL.Hours AS Sick_Leave, V.Hours AS Vacation, CL.Hours AS Compassionate_Leave, BT.Hours AS Business_Travel, ML.Hours AS Maternity_Leave, GL.Hours AS Gardening_Leave, EH.Hours AS Extra_Hours INTO Report_Month1_SalesFROM ((((((((((Monthly_Reporting_Data AS MR LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('Shift') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS W ON (W.Day = MR.Day) AND (W.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('Break','Lunch') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS B ON (B.Day = MR.Day) AND (B.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('Holiday') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS H ON (H.Day = MR.Day) AND (H.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Sick Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS SL ON (SL.Day = MR.Day) AND (SL.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Vacation') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS V ON (V.Day = MR.Day) AND (V.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Compassionate Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS CL ON (CL.Day = MR.Day) AND (CL.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Business travel') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS BT ON (BT.Day = MR.Day) AND (BT.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Maternity Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS ML ON (ML.Day = MR.Day) AND (ML.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Gardening Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS GL ON (GL.Day = MR.Day) AND (GL.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Extra Hours') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS EH ON (EH.Day = MR.Day) AND (EH.EmployeeID = MR.EmployeeID)) LEFT JOIN Month1 AS M1 ON (YEAR(MR.Day) = M1.current_year) AND (MONTH(MR.Day) = M1.current_month)WHERE Office In ('Zagreb Office','Zagreb Students') And Department In ('Sales') And M1.current_month Is Not NullGROUP BY MR.Lastname, MR.Firstname, MR.EmployeeID, MR.Day, W.Hours, B.Hours, H.Hours, SL.Hours, V.Hours, CL.Hours, BT.Hours, ML.Hours, GL.Hours, EH.HoursORDER BY MR.EmployeeID, MR.Day;"
            }
        },
        {
            "11": {
                "name": "Report for Month 2 - Airlines",
                "sql": "SELECT DISTINCT MR.Lastname, MR.Firstname, MR.EmployeeID, MR.Day, MIN(MR.Time_In) AS TimeIn, W.Hours AS Worked, B.Hours AS Breaks, H.Hours AS Holiday, SL.Hours AS Sick_Leave, V.Hours AS Vacation, CL.Hours AS Compassionate_Leave, BT.Hours AS Business_Travel, ML.Hours AS Maternity_Leave, GL.Hours AS Gardening_Leave, EH.Hours AS Extra_Hours INTO Report_Month2_AirlinesFROM ((((((((((Monthly_Reporting_Data AS MR LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('Shift') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS W ON (W.Day = MR.Day) AND (W.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('Break','Lunch') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS B ON (B.Day = MR.Day) AND (B.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('Holiday') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS H ON (H.Day = MR.Day) AND (H.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Sick Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS SL ON (SL.Day = MR.Day) AND (SL.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Vacation') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS V ON (V.Day = MR.Day) AND (V.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Compassionate Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS CL ON (CL.Day = MR.Day) AND (CL.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Business travel') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS BT ON (BT.Day = MR.Day) AND (BT.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Maternity Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS ML ON (ML.Day = MR.Day) AND (ML.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Gardening Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS GL ON (GL.Day = MR.Day) AND (GL.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Extra Hours') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS EH ON (EH.Day = MR.Day) AND (EH.EmployeeID = MR.EmployeeID)) LEFT JOIN Month2 AS M2 ON (YEAR(MR.Day) = M2.current_year) AND (MONTH(MR.Day) = M2.current_month)WHERE Office In ('Zagreb Office','Zagreb Students') And Department In ('Airlines') And M2.current_month Is Not NullGROUP BY MR.Lastname, MR.Firstname, MR.EmployeeID, MR.Day, W.Hours, B.Hours, H.Hours, SL.Hours, V.Hours, CL.Hours, BT.Hours, ML.Hours, GL.Hours, EH.HoursORDER BY MR.EmployeeID, MR.Day;"
            }
        },
        {
            "11a": {
                "name": "Report for Month 2 - Fleets",
                "sql": "SELECT DISTINCT MR.Lastname, MR.Firstname, MR.EmployeeID, MR.Day, MIN(MR.Time_In) AS TimeIn, W.Hours AS Worked, B.Hours AS Breaks, H.Hours AS Holiday, SL.Hours AS Sick_Leave, V.Hours AS Vacation, CL.Hours AS Compassionate_Leave, BT.Hours AS Business_Travel, ML.Hours AS Maternity_Leave, GL.Hours AS Gardening_Leave, EH.Hours AS Extra_Hours INTO Report_Month2_FleetsFROM ((((((((((Monthly_Reporting_Data AS MR LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('Shift') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS W ON (W.Day = MR.Day) AND (W.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('Break','Lunch') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS B ON (B.Day = MR.Day) AND (B.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('Holiday') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS H ON (H.Day = MR.Day) AND (H.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Sick Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS SL ON (SL.Day = MR.Day) AND (SL.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Vacation') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS V ON (V.Day = MR.Day) AND (V.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Compassionate Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS CL ON (CL.Day = MR.Day) AND (CL.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Business travel') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS BT ON (BT.Day = MR.Day) AND (BT.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Maternity Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS ML ON (ML.Day = MR.Day) AND (ML.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Gardening Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS GL ON (GL.Day = MR.Day) AND (GL.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Extra Hours') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS EH ON (EH.Day = MR.Day) AND (EH.EmployeeID = MR.EmployeeID)) LEFT JOIN Month2 AS M2 ON (YEAR(MR.Day) = M2.current_year) AND (MONTH(MR.Day) = M2.current_month)WHERE Office In ('Zagreb Office','Zagreb Students') And Department In ('Fleets') And M2.current_month Is Not NullGROUP BY MR.Lastname, MR.Firstname, MR.EmployeeID, MR.Day, W.Hours, B.Hours, H.Hours, SL.Hours, V.Hours, CL.Hours, BT.Hours, ML.Hours, GL.Hours, EH.HoursORDER BY MR.EmployeeID, MR.Day;"
            }
        },
        {
            "11b": {
                "name": "Report for Month 2 - Admin and Management",
                "sql": "SELECT DISTINCT MR.Lastname, MR.Firstname, MR.EmployeeID, MR.Day, MIN(MR.Time_In) AS TimeIn, W.Hours AS Worked, B.Hours AS Breaks, H.Hours AS Holiday, SL.Hours AS Sick_Leave, V.Hours AS Vacation, CL.Hours AS Compassionate_Leave, BT.Hours AS Business_Travel, ML.Hours AS Maternity_Leave, GL.Hours AS Gardening_Leave, EH.Hours AS Extra_Hours INTO Report_Month2_Admin_MgmtFROM ((((((((((Monthly_Reporting_Data AS MR LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('Shift') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS W ON (W.Day = MR.Day) AND (W.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('Break','Lunch') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS B ON (B.Day = MR.Day) AND (B.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('Holiday') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS H ON (H.Day = MR.Day) AND (H.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Sick Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS SL ON (SL.Day = MR.Day) AND (SL.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Vacation') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS V ON (V.Day = MR.Day) AND (V.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Compassionate Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS CL ON (CL.Day = MR.Day) AND (CL.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Business travel') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS BT ON (BT.Day = MR.Day) AND (BT.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Maternity Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS ML ON (ML.Day = MR.Day) AND (ML.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Gardening Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS GL ON (GL.Day = MR.Day) AND (GL.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Extra Hours') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS EH ON (EH.Day = MR.Day) AND (EH.EmployeeID = MR.EmployeeID)) LEFT JOIN Month2 AS M2 ON (YEAR(MR.Day) = M2.current_year) AND (MONTH(MR.Day) = M2.current_month)WHERE Office In ('Zagreb Office','Zagreb Students') And Department In ('Administration','Management') And M2.current_month Is Not NullGROUP BY MR.Lastname, MR.Firstname, MR.EmployeeID, MR.Day, W.Hours, B.Hours, H.Hours, SL.Hours, V.Hours, CL.Hours, BT.Hours, ML.Hours, GL.Hours, EH.HoursORDER BY MR.EmployeeID, MR.Day;"
            }
        },
        {
            "11c": {
                "name": "Report for Month 2 - Sales",
                "sql": "SELECT DISTINCT MR.Lastname, MR.Firstname, MR.EmployeeID, MR.Day, MIN(MR.Time_In) AS TimeIn, W.Hours AS Worked, B.Hours AS Breaks, H.Hours AS Holiday, SL.Hours AS Sick_Leave, V.Hours AS Vacation, CL.Hours AS Compassionate_Leave, BT.Hours AS Business_Travel, ML.Hours AS Maternity_Leave, GL.Hours AS Gardening_Leave, EH.Hours AS Extra_Hours INTO Report_Month2_SalesFROM ((((((((((Monthly_Reporting_Data AS MR LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('Shift') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS W ON (W.Day = MR.Day) AND (W.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('Break','Lunch') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS B ON (B.Day = MR.Day) AND (B.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('Holiday') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS H ON (H.Day = MR.Day) AND (H.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Sick Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS SL ON (SL.Day = MR.Day) AND (SL.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Vacation') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS V ON (V.Day = MR.Day) AND (V.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Compassionate Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS CL ON (CL.Day = MR.Day) AND (CL.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Business travel') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS BT ON (BT.Day = MR.Day) AND (BT.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Maternity Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS ML ON (ML.Day = MR.Day) AND (ML.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Gardening Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS GL ON (GL.Day = MR.Day) AND (GL.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office In ('Zagreb Office','Zagreb Students') And Type In ('TimeOff') And Category=('Extra Hours') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS EH ON (EH.Day = MR.Day) AND (EH.EmployeeID = MR.EmployeeID)) LEFT JOIN Month2 AS M2 ON (YEAR(MR.Day) = M2.current_year) AND (MONTH(MR.Day) = M2.current_month)WHERE Office In ('Zagreb Office','Zagreb Students') And Department In ('Sales') And M2.current_month Is Not NullGROUP BY MR.Lastname, MR.Firstname, MR.EmployeeID, MR.Day, W.Hours, B.Hours, H.Hours, SL.Hours, V.Hours, CL.Hours, BT.Hours, ML.Hours, GL.Hours, EH.HoursORDER BY MR.EmployeeID, MR.Day;"
            }
        },
        {
            "12": {
                "name": "Create Current Balances",
                "sql": "SELECT Month1.*, Month2.Balance_Month2, ROUND(Month1.Balance_Month1+Month2.Balance_Month2,2) AS Total_Balance INTO Current_BalancesFROM (SELECT M1.Radnik AS Employee, ROUND(SUM(M1.[od toga Sati rada u preraspod  rad vremen (6b)]),2) AS Balance_Month1 FROM Final_Evidencija_o_radnom_vremenu_Month1 AS M1 GROUP BY M1.Radnik)  AS Month1 LEFT JOIN (SELECT M2.Radnik AS Employee, ROUND(SUM(M2.[od toga Sati rada u preraspod  rad vremen (6b)]),2) AS Balance_Month2 FROM Final_Evidencija_o_radnom_vremenu_Month2 AS M2 GROUP BY M2.Radnik)  AS Month2 ON Month1.Employee = Month2.Employee;"
            }
        },
        {
            "13": {
                "name": "Delete StaffReport",
                "sql": "DELETE *FROM StaffReport;"
            }
        },
        {
            "14": {
                "name": "Create e-mail report",
                "sql": "SELECT * INTO Email_ReportFROM Current_Balances AS CB LEFT JOIN StaffReport AS SR ON SR.Firstname & ' ' & SR.Lastname = CB.Employee;"
            }
        },
        {
            "15": {
                "name": "Create daily Student Hours Month 1",
                "sql": "SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Daily_Hours INTO Daily_Student_Hours_Month1FROM Monthly_Reporting_Data AS MR LEFT JOIN Month1 AS M1 ON (YEAR(MR.Day) = M1.current_year) AND (MONTH(MR.Day) = M1.current_month)WHERE Office = 'Zagreb Students' AND Hours_Recorded <> 0 AND M1.current_month IS NOT NULLGROUP BY Lastname, Firstname, EmployeeID, Day;"
            }
        },
        {
            "15a": {
                "name": "Create daily Student Hours Month 2",
                "sql": "SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Daily_Hours INTO Daily_Student_Hours_Month2FROM Monthly_Reporting_Data AS MR LEFT JOIN Month2 AS M2 ON (MONTH(MR.Day) = M2.current_month) AND (YEAR(MR.Day) = M2.current_year)WHERE Office = 'Zagreb Students' AND Hours_Recorded <> 0 AND M2.current_month IS NOT NULLGROUP BY Lastname, Firstname, EmployeeID, Day;"
            }
        },
        {
            "16": {
                "name": "Create Daily Student Hours incl Break Month 1",
                "sql": "SELECT DS.*, IIF(Daily_Hours>6,ROUND(Daily_Hours+0.5,2),ROUND(Daily_Hours,2)) AS Daily_Hours_Incl_Break, IIF(Daily_Hours>6,0.5,0) AS Paid_Break INTO Student_Hours_Incl_Breaks_Month1FROM Daily_Student_Hours_Month1 AS DS;"
            }
        },
        {
            "16b": {
                "name": "Create Daily Student Hours incl Break Month 2",
                "sql": "SELECT DS.*, IIF(Daily_Hours>6,ROUND(Daily_Hours+0.5,2),ROUND(Daily_Hours,2)) AS Daily_Hours_Incl_Break, IIF(Daily_Hours>6,0.5,0) AS Paid_Break INTO Student_Hours_Incl_Breaks_Month2FROM Daily_Student_Hours_Month2 AS DS;"
            }
        },
        {
            "17": {
                "name": "Hours to be reported to Student Centre Month 1",
                "sql": "SELECT Lastname, Firstname, EmployeeiD, SUM(Daily_Hours_Incl_Break) AS Hours_To_Be_ReportedFROM Student_Hours_Incl_Breaks_Month1GROUP BY Lastname, Firstname, EmployeeiD;"
            }
        },
        {
            "17b": {
                "name": "Hours to be reported to Student Centre Month 2",
                "sql": "SELECT Lastname, Firstname, EmployeeiD, SUM(Daily_Hours_Incl_Break) AS Hours_To_Be_ReportedFROM Student_Hours_Incl_Breaks_Month2GROUP BY Lastname, Firstname, EmployeeiD;"
            }
        },
        {
            "2": {
                "name": "Create Monthly_Reporting_Data",
                "sql": "SELECT * INTO Monthly_Reporting_DataFROM (SELECT Lastname, Firstname, EmployeeID, Department, Office, DateValue(TimeIn) as Day, MIN(TimeIn) AS Time_In, Type, Category, SUM(Hours) AS Hours_Recorded FROM Working_Hours_PurelyHRWHERE (Type = 'Lunch' OR TYPE = 'Shift' OR Type = 'Break')GROUP BY Lastname, Firstname, EmployeeID, Department, Office, DateValue(TimeIn), Type, CategoryUNIONSELECT Lastname, Firstname, EmployeeID, Department, Office, DateValue(TimeIn) as Day, NULL AS Time_In, Type, Category, SUM(Hours) AS Hours_Recorded FROM Working_Hours_PurelyHRWHERE (Type = 'Holiday' OR (Type = 'TimeOff' AND Category <> 'Extra hours'))GROUP BY Lastname, Firstname, EmployeeID, Department, Office, TimeIn, Type, CategoryUNIONSELECT Lastname, Firstname, EmployeeID, Department, Office, DateValue(TimeIn) as Day, NULL AS Time_In, Type, Category, 0 AS Hours_Recorded FROM Working_Hours_PurelyHRWHERE (Type = 'TimeOff' AND Category = 'Extra hours')GROUP BY Lastname, Firstname, EmployeeID, Department, Office, TimeIn, Type, Category)  AS temp;"
            }
        },
        {
            "3": {
                "name": "Update Hours to 8 in Monthly_Reporting_Data",
                "sql": "UPDATE Monthly_Reporting_Data SET Hours_Recorded = 8WHERE Hours_Recorded=7.5 And Type Not In ('Break','Lunch','Shift');"
            }
        },
        {
            "4": {
                "name": "Check Hours Data Integrity",
                "sql": "TRANSFORM Sum(Monthly_Reporting_Data.Hours_Recorded) AS SumOfHours_RecordedSELECT Monthly_Reporting_Data.Lastname, Monthly_Reporting_Data.Firstname, Monthly_Reporting_Data.EmployeeID, Sum(Monthly_Reporting_Data.Hours_Recorded) AS [Total Of Hours_Recorded]FROM Monthly_Reporting_DataWHERE (((Monthly_Reporting_Data.Office)='Zagreb Office'))GROUP BY Monthly_Reporting_Data.Lastname, Monthly_Reporting_Data.Firstname, Monthly_Reporting_Data.EmployeeIDPIVOT Format([Day],'Short Date');"
            }
        },
        {
            "5": {
                "name": "Find Period 1 Month",
                "sql": "SELECT DISTINCT MIN(MONTH(Day)) AS current_month, YEAR (Day) AS current_year INTO Month1FROM Monthly_Reporting_DataGROUP BY Year(Day);"
            }
        },
        {
            "5a": {
                "name": "Find Period 2 Month",
                "sql": "SELECT DISTINCT MAX(MONTH(Day)) AS current_month, YEAR (Day) AS current_year INTO Month2FROM Monthly_Reporting_DataGROUP BY Year(Day);"
            }
        },
        {
            "6": {
                "name": "Create updated Employee List",
                "sql": "SELECT DISTINCT Lastname, Firstname, EmployeeID, Min(Day) AS First_Day, Max(Day) AS Last_Day, Month(Day) AS [Month], Year(Day) AS [Year] INTO EmployeesFROM Monthly_Reporting_DataWHERE Office = 'Zagreb Office'GROUP BY Lastname, Firstname, EmployeeID, Month(Day), Year(Day);"
            }
        },
        {
            "7": {
                "name": "Create cartesian product for RBD Month 1",
                "sql": "SELECT DISTINCT 'CH-AVIATION SERVICES d.o.o.' AS Poslodavac, Month_Weird_Format AS Mjesec, E.Firstname & ' ' & E.Lastname AS Radnik, Date, Lastname, Firstname INTO Reporting_Base_Data_Cartesian_M1FROM Reporting_Days AS RD, Employees AS E, Month1 AS M1WHERE RD.Month = M1.current_month AND RD.Year = M1.current_yearORDER BY E.Lastname, E.Firstname, Date;"
            }
        },
        {
            "7a": {
                "name": "Create cartesian product for RBD Month 2",
                "sql": "SELECT DISTINCT 'CH-AVIATION SERVICES d.o.o.' AS Poslodavac, Month_Weird_Format AS Mjesec, E.Firstname & ' ' & E.Lastname AS Radnik, Date, Lastname, Firstname INTO Reporting_Base_Data_Cartesian_M2FROM Reporting_Days AS RD, Employees AS E, Month2 AS M2WHERE RD.Month = M2.current_month AND RD.Year = M2.current_yearORDER BY E.Lastname, E.Firstname, Date;"
            }
        },
        {
            "8": {
                "name": "Create Eorv Month 1",
                "sql": "SELECT DISTINCT MR.Lastname, MR.Firstname, MR.EmployeeID, MR.Day, MIN(MR.Time_In) AS TimeIn, W.Hours AS Worked, H.Hours AS Holiday, SL.Hours AS Sick_Leave, V.Hours AS Vacation, CL.Hours AS Compassionate_Leave, BT.Hours AS Business_Travel, ML.Hours AS Maternity_Leave, GL.Hours AS Gardening_Leave, EH.Hours AS Extra_Hours INTO Evidencija_o_radnom_vremenu_Month1FROM (((((((((Monthly_Reporting_Data AS MR LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office='Zagreb Office' And Type In ('Shift','Break','Lunch') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS W ON (W.EmployeeID = MR.EmployeeID) AND (W.Day = MR.Day)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office = 'Zagreb Office' AND Type IN ('Holiday') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS H ON (H.EmployeeID = MR.EmployeeID) AND (H.Day = MR.Day)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office = 'Zagreb Office' AND Type IN ('TimeOff') AND Category = ('Sick Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS SL ON (SL.EmployeeID = MR.EmployeeID) AND (SL.Day = MR.Day)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office = 'Zagreb Office' AND Type IN ('TimeOff') AND Category = ('Vacation') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS V ON (V.EmployeeID = MR.EmployeeID) AND (V.Day = MR.Day)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office = 'Zagreb Office' AND Type IN ('TimeOff') AND Category = ('Compassionate Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS CL ON (CL.EmployeeID = MR.EmployeeID) AND (CL.Day = MR.Day)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office = 'Zagreb Office' AND Type IN ('TimeOff') AND Category = ('Business travel') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS BT ON (BT.EmployeeID = MR.EmployeeID) AND (BT.Day = MR.Day)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office = 'Zagreb Office' AND Type IN ('TimeOff') AND Category = ('Maternity Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS ML ON (ML.EmployeeID = MR.EmployeeID) AND (ML.Day = MR.Day)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office = 'Zagreb Office' AND Type IN ('TimeOff') AND Category = ('Gardening Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS GL ON (GL.EmployeeID = MR.EmployeeID) AND (GL.Day = MR.Day)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office = 'Zagreb Office' AND Type IN ('TimeOff') AND Category = ('Extra Hours') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS EH ON (EH.EmployeeID = MR.EmployeeID) AND (EH.Day = MR.Day)) LEFT JOIN Month1 AS M1 ON (MONTH(MR.Day) = M1.current_month) AND (YEAR(MR.Day) = M1.current_year)WHERE Office = 'Zagreb Office' AND M1.current_month IS NOT NULLGROUP BY MR.Lastname, MR.Firstname, MR.EmployeeID, MR.Day, W.Hours, H.Hours, SL.Hours, V.Hours, CL.Hours, BT.Hours, ML.Hours, GL.Hours, EH.Hours;"
            }
        },
        {
            "8a": {
                "name": "Create Eorv Month 2",
                "sql": "SELECT DISTINCT MR.Lastname, MR.Firstname, MR.EmployeeID, MR.Day, MIN(MR.Time_In) AS TimeIn, W.Hours AS Worked, H.Hours AS Holiday, SL.Hours AS Sick_Leave, V.Hours AS Vacation, CL.Hours AS Compassionate_Leave, BT.Hours AS Business_Travel, ML.Hours AS Maternity_Leave, GL.Hours AS Gardening_Leave, EH.Hours AS Extra_Hours INTO Evidencija_o_radnom_vremenu_Month2FROM (((((((((Monthly_Reporting_Data AS MR LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office='Zagreb Office' And Type In ('Shift','Break','Lunch') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS W ON (W.Day = MR.Day) AND (W.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office = 'Zagreb Office' AND Type IN ('Holiday') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS H ON (H.Day = MR.Day) AND (H.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office = 'Zagreb Office' AND Type IN ('TimeOff') AND Category = ('Sick Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS SL ON (SL.Day = MR.Day) AND (SL.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office = 'Zagreb Office' AND Type IN ('TimeOff') AND Category = ('Vacation') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS V ON (V.Day = MR.Day) AND (V.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office = 'Zagreb Office' AND Type IN ('TimeOff') AND Category = ('Compassionate Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS CL ON (CL.Day = MR.Day) AND (CL.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office = 'Zagreb Office' AND Type IN ('TimeOff') AND Category = ('Business travel') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS BT ON (BT.Day = MR.Day) AND (BT.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office = 'Zagreb Office' AND Type IN ('TimeOff') AND Category = ('Maternity Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS ML ON (ML.Day = MR.Day) AND (ML.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office = 'Zagreb Office' AND Type IN ('TimeOff') AND Category = ('Gardening Leave') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS GL ON (GL.Day = MR.Day) AND (GL.EmployeeID = MR.EmployeeID)) LEFT JOIN (SELECT Lastname, Firstname, EmployeeID, Day, SUM(Hours_Recorded) AS Hours FROM Monthly_Reporting_Data WHERE Office = 'Zagreb Office' AND Type IN ('TimeOff') AND Category = ('Extra Hours') GROUP BY Lastname, Firstname, EmployeeID, Day)  AS EH ON (EH.Day = MR.Day) AND (EH.EmployeeID = MR.EmployeeID)) LEFT JOIN Month2 AS M2 ON (YEAR(MR.Day) = M2.current_year) AND (MONTH(MR.Day) = M2.current_month)WHERE Office = 'Zagreb Office' AND M2.current_month IS NOT NULLGROUP BY MR.Lastname, MR.Firstname, MR.EmployeeID, MR.Day, W.Hours, H.Hours, SL.Hours, V.Hours, CL.Hours, BT.Hours, ML.Hours, GL.Hours, EH.Hours;"
            }
        },
        {
            "9": {
                "name": "Create Evidencija o radnom vremenu Month 1",
                "sql": "SELECT Poslodavac, Mjesec, Radnik, C.Date AS [Datum u mjesecu (1)], 'Sjedište' AS [Ozanaka PP (2)], FORMAT(TimeIn,'Short Time') AS [Pocetak rada u preraspodjeljenom radnom vremenu (3)], IIF(E.Worked>6,FORMAT(TimeIn+((E.Worked+0.5)/24),'Short Time'),FORMAT(TimeIn+((E.Worked)/24),'Short Time')) AS [Kraj rada u preraspodjeljenom radnom vremenu (4)], 0 AS [Vrijeme i sati zastoja prekida rada i sl do kojeg je (5)], IIF(E.Worked>6,ROUND(nz(E.Worked)+0.5+nz(E.Holiday)+nz(E.Sick_Leave)+nz(E.Vacation)+nz(E.Business_Travel)+nz(E.Maternity_Leave)+nz(E.Compassionate_Leave)+nz(E.Gardening_Leave),2),ROUND(nz(E.Worked)+nz(E.Holiday)+nz(E.Sick_Leave)+nz(E.Vacation)+nz(E.Business_Travel)+nz(E.Maternity_Leave)+nz(E.Compassionate_Leave)+nz(E.Gardening_Leave),2)) AS [Ukupno odradeni sati na dnevnoj razini (6)], IIF(E.Firstname IS NULL,0,IIF(RD.Weekday<6,8,0)) AS [Ukupni fond sati na dnevnoj razini (prema mjesecnom fondu) (6a)], IIF(E.Worked>6,ROUND(nz(E.Worked)+0.5+nz(E.Holiday)+nz(E.Sick_Leave)+nz(E.Vacation)+nz(E.Business_Travel)+nz(E.Maternity_Leave)+nz(E.Compassionate_Leave)+nz(E.Gardening_Leave-(IIF(E.Firstname IS NULL,0,IIF(RD.Weekday<6,8,0)))),2),ROUND(nz(E.Worked)+nz(E.Holiday)+nz(E.Sick_Leave)+nz(E.Vacation)+nz(E.Business_Travel)+nz(E.Maternity_Leave)+nz(E.Compassionate_Leave)+nz(E.Gardening_Leave),2))-IIF(E.Firstname IS NULL,0,IIF(RD.Weekday<6,8,0)) AS [od toga Sati rada u preraspod  rad vremen (6b)], 0 AS [od toga sati rada nocu (6e)], 0 AS [od toga: sati prekovre-menog rada (6g)], 0 AS [Sati rada nedjeljom, blagdanom ili neradnim (7)], IIF(E.Holiday>0,E.Holiday,0) AS [Neradni dani i blagdani (8)], 0 AS [Sati terenskog rada (9)], 0 AS [Sati pripravnosti te sati rada po pozivu (10)], IIF(E.Vacation>0,E.Vacation,0) AS [Sati godišnjeg odmora (11)], IIf(E.Sick_Leave>0,ROUND(E.Sick_Leave,2),0) AS [Sati privremene nesposob za rad (bolovanje) (12)], IIf(E.Maternity_Leave>0,E.Maternity_Leave,0) AS [Vrijeme rodiljnog, roditeljskog dopusta ili …  (13)], IIf(E.Compassionate_Leave>0,E.Compassionate_Leave,0) AS [Sati placenog dopusta (14)], 0 AS [Sati nepla-cenog dopusta (15)], IIF(E.Gardening_Leave>0,E.Gardening_Leave,0) AS [Sati nenazocnosti u tijeku dnevnog rasporeda … (16)], 0 AS [Sati provedeni u štrajku(17)], 0 AS [Sati iskljucenja s rada (lockout) (18)] INTO Final_Evidencija_o_radnom_vremenu_Month1FROM ((Reporting_Base_Data_Cartesian_M1 AS C LEFT JOIN Evidencija_o_radnom_vremenu_Month1 AS E ON (C.Date = E.Day) AND (C.Firstname = E.Firstname) AND (C.Lastname = E.Lastname)) LEFT JOIN Reporting_Days AS RD ON C.Date = RD.Date) LEFT JOIN Month1 AS M1 ON (MONTH(C.Date) = M1.current_month) AND (YEAR(C.Date) = M1.current_year)ORDER BY Radnik, C.Date;"
            }
        },
        {
            "9a": {
                "name": "Create Evidencija o radnom vremenu Month 2",
                "sql": "SELECT Poslodavac, Mjesec, Radnik, C.Date AS [Datum u mjesecu (1)], 'Sjedište' AS [Ozanaka PP (2)], FORMAT(TimeIn,'Short Time') AS [Pocetak rada u preraspodjeljenom radnom vremenu (3)], IIF(E.Worked>6,FORMAT(TimeIn+((E.Worked+0.5)/24),'Short Time'),FORMAT(TimeIn+((E.Worked)/24),'Short Time')) AS [Kraj rada u preraspodjeljenom radnom vremenu (4)], 0 AS [Vrijeme i sati zastoja prekida rada i sl do kojeg je (5)], IIF(E.Worked>6,ROUND(nz(E.Worked)+0.5+nz(E.Holiday)+nz(E.Sick_Leave)+nz(E.Vacation)+nz(E.Business_Travel)+nz(E.Maternity_Leave)+nz(E.Compassionate_Leave)+nz(E.Gardening_Leave),2),ROUND(nz(E.Worked)+nz(E.Holiday)+nz(E.Sick_Leave)+nz(E.Vacation)+nz(E.Business_Travel)+nz(E.Maternity_Leave)+nz(E.Compassionate_Leave)+nz(E.Gardening_Leave),2)) AS [Ukupno odradeni sati na dnevnoj razini (6)], IIF(E.Firstname IS NULL,0,IIF(RD.Weekday<6,8,0)) AS [Ukupni fond sati na dnevnoj razini (prema mjesecnom fondu) (6a)], IIF(E.Worked>6,ROUND(nz(E.Worked)+0.5+nz(E.Holiday)+nz(E.Sick_Leave)+nz(E.Vacation)+nz(E.Business_Travel)+nz(E.Maternity_Leave)+nz(E.Compassionate_Leave)+nz(E.Gardening_Leave-(IIF(E.Firstname IS NULL,0,IIF(RD.Weekday<6,8,0)))),2),ROUND(nz(E.Worked)+nz(E.Holiday)+nz(E.Sick_Leave)+nz(E.Vacation)+nz(E.Business_Travel)+nz(E.Maternity_Leave)+nz(E.Compassionate_Leave)+nz(E.Gardening_Leave),2))-IIF(E.Firstname IS NULL,0,IIF(RD.Weekday<6,8,0)) AS [od toga Sati rada u preraspod  rad vremen (6b)], 0 AS [od toga sati rada nocu (6e)], 0 AS [od toga: sati prekovre-menog rada (6g)], 0 AS [Sati rada nedjeljom, blagdanom ili neradnim (7)], IIF(E.Holiday>0,E.Holiday,0) AS [Neradni dani i blagdani (8)], 0 AS [Sati terenskog rada (9)], 0 AS [Sati pripravnosti te sati rada po pozivu (10)], IIF(E.Vacation>0,E.Vacation,0) AS [Sati godišnjeg odmora (11)], IIf(E.Sick_Leave>0,ROUND(E.Sick_Leave,2),0) AS [Sati privremene nesposob za rad (bolovanje) (12)], IIf(E.Maternity_Leave>0,E.Maternity_Leave,0) AS [Vrijeme rodiljnog, roditeljskog dopusta ili …  (13)], IIf(E.Compassionate_Leave>0,E.Compassionate_Leave,0) AS [Sati placenog dopusta (14)], 0 AS [Sati nepla-cenog dopusta (15)], IIF(E.Gardening_Leave>0,E.Gardening_Leave,0) AS [Sati nenazocnosti u tijeku dnevnog rasporeda … (16)], 0 AS [Sati provedeni u štrajku(17)], 0 AS [Sati iskljucenja s rada (lockout) (18)] INTO Final_Evidencija_o_radnom_vremenu_Month2FROM ((Reporting_Base_Data_Cartesian_M2 AS C LEFT JOIN Evidencija_o_radnom_vremenu_Month2 AS E ON (C.Lastname = E.Lastname) AND (C.Firstname = E.Firstname) AND (C.Date = E.Day)) LEFT JOIN Reporting_Days AS RD ON C.Date = RD.Date) LEFT JOIN Month2 AS M2 ON (YEAR(C.Date) = M2.current_year) AND (MONTH(C.Date) = M2.current_month)ORDER BY Radnik, C.Date;"
            }
        }
    ]
}